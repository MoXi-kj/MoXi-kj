1、红外单帧图像弱小目标检测技术研究
红外弱小目标检测技术已成为国内外红外领域研究的重点。对红外弱小目标的特征进行了介绍；本研究方法主要从基于滤波（空间域和变换域的滤波）、人类视觉系统以及图像数据结构３个方面，对当前单帧图像的红外弱小目标检测算法的 原理、主要步骤及特点进行了综述。
根据检测小目标所采用的基本思想，可以将相关算法分为基于滤波的方法、基于人类视觉系统（ＨＶＳ）的方法、基于图像数据结构的方法３大类。
其中，基于滤波的方法主要通过抑制背景进而达到检测红外弱小目标的目的，根据处理角度的不同可以分为基于空间域的处理方法和基于变换域的处理方法两种；
基于ＨＶＳ的方法通过目标与背景的局部差异构建可以突出目标的显著图，进而实现对目标的检测。
基于图像数据结构的方法则利用目标矩阵与背景矩阵之间的特征差异从单帧图像中分离出目标。
2、红外弱小目标检测方法分析
2.1、红外弱小目标的特征
红外弱小目标在成像系统中的特点可以简单概括为“弱”和“小”两个方面。其中“弱”主要表现为对比度及信噪比较低，“小”则主要表现为目标所占像素数目少,导致目标缺乏固定的形状和纹理特征。根据国际光学工程学会（SPIE）对红外弱小目标的定义，对于大小为256piexl×256piexl的图像，成像尺寸小于总像素数的0.12%（即小于81piexl）的目标为弱小目标.
2.2、红外弱小目标检测方法的评价指标
信杂比增益、背景抑制因子、正确检测概率、虚警率和算法消耗时间等指标常用于客观评价基于单帧图像的红外弱小目标检测算法的性能。
其中信杂比增益用于表示经算法处理后对目标显著性的改善程度，信杂比增益越大，表示算法突出目标的效果越好。信杂比ＳＳＣＲ和信杂比增益ＧＳＣＲ分别表示为.
 
式中：μｔ 和μｂ 分别为目标区域和整幅图像的平均灰度；σｂ 为整幅图像的标准差；ＳＳＣＲ＿ｉｎ和ＳＳＣＲ＿ｏｕｔ分别为经算法处理前后图像的信杂比。
背景抑制因子ＢＢＳＦ主要用于表示算法对背景的抑制能力，值越大表示算法对背景的抑制能力越强，算法性能越好，表示为
 
式中：ＣＩＮ和ＣＯＵＴ分别表示算法处理前后整幅图像的标准差。
信杂比和背景抑制因子为最常用的分别用于描述目标增强和背景抑制程度的指标。
而正确检测概率和虚警率常用于评价算法的检测效果。正确检测概率为正确检测的目标数与总的真实目标数之比，虚警率为错误检测的像素数与整幅图像像素总数之比。这些评价指标主要用于描述算法可靠性，对于算法的实时性，一般通过算法运行所消耗的时间进行描述。
３ 红外弱小目标检测方法
3.1 基于滤波的方法
基于滤波的方法主要通过抑制背景进而达到检测红外弱小目标的目的，据处理角度的不同可以分为基于空间域的处理方法和基于变换域的处理方法两种。
3.1.1基于空间域滤波的方法
采用空间域滤波方法对红外弱小目标进行检测的主要思路为：先通过滤波对背景进行估计，然后将原始图像与滤波得到的背景图像进行差分以突出小目标，最后对差分图像进行阈值分割，实现对小目标的检测。此种方法的重点在于通过滤波实现背景抑制。
常用的高通滤波器分为空域和频域两类。
3.1.1.1 空域高通滤波
空域高通滤波方法[1]主要利用小目标与背景间的灰度差异进行目标检测。该方法通过相应的高通滤波模板与图像卷积来近似频域上的高通滤波
高通滤波模板的特点：在模板内值的和为０的条件下，模板中心或靠近中心的权值取较大的正值，靠近模板边缘的权值取负值。这样就会使孤立噪声点和小目标容易通过模板，而对平缓变化的背景产生抑制。
假设滤波器的输入为函数 f(x,y)， 输出信号为 g(x,y)， 设滤波器的脉冲响应函数为 h(x,y)，用*表示卷积运算，则：
g(x, y) = f(x, y) * h(x, y)
对于离散图像， 一般选用卷模板表示滤波器的脉冲响应函数， 记为矩阵 H。根据目标的具体信息，如采用的两个空域 5×5 高通滤波器，其卷积模板如下：
 
对于空域模板 H1，中心像素权值最大，易通过，而周围部分权值均为-1，值小，不易通过。 这样，对于孤立噪声点和小目标，信号强度高，易通过。而有一定面积的背景不易通过，可以较好地抑制背景。空域模板 H2 将中心高权值分布在十字形区域中，使权值分散，必然使滤波后的小目标发生膨胀，面积变大，被滤掉的背景灰度变得更均匀。
3.1.1.2 中值滤波
中值滤波技术是1971年由 Turkry提出的一种经典的非线性空域滤波方法。其主要思想是用像素点某邻域内的灰度中值代替该点的灰度值，以实现对图像中平缓变化背景的预测，抑制点状噪声和干扰脉冲［１４］。
由于进行中值滤波操作时，需要对窗口内的所有像素的灰度值进行排序，因此滤波窗口的大小和形状会对滤波效果以及计算量产生较大的影响。
中值滤波也是消除图像噪声最常见的手段之一，特别是消除椒盐噪声，中值滤波的效果要比均值滤波更好。中值滤波是跟均值滤波唯一不同是，不是用均值来替换中心每个像素，而是将周围像素和中心像素排序以后，取中值，一个3X3大小的中值滤波如下：
 
3.1.1.3 最大中值/最大均值滤波法
算法通常是在一幅L × L 的二维数字图像上， 取一个大小为 2M + 1 的窗口内( L 远大于 M ) ， 分别沿水平、垂直、2 个对角线方向分别求每条线上的中值或均值， 再分别取其最大值作为窗口中心点的像素值。
Y(m,n)Max-median输出为：
y(m,n)=max{z_1,z_2,z_3,z_4}
式中：
z_1=median{x(m,n-N), .. ,x(m,n), … ,x(m,n+N)};
z_2= median{x(m-N,n), .. ,x(m,n), … ,x(m+N,n)};
z_3= median{x(m+N,n-N), .. ,x(m,n), … ,x(m-N,n+N)};
z_4= median{x(m-N,n-N), .. ,x(m,n), … ,x(m+N,n+N)};

Max-mean输出为：
Y(m,n)Max-mean输出为：
y(m,n)=max{z_1,z_2,z_3,z_4}
式中：
z_1=mean{x(m,n-N), .. ,x(m,n), … ,x(m,n+N)};
z_2= mean{x(m-N,n), .. ,x(m,n), … ,x(m+N,n)};
z_3= mean{x(m+N,n-N), .. ,x(m,n), … ,x(m-N,n+N)};
z_4= mean{x(m-N,n-N), .. ,x(m,n), … ,x(m+N,n+N)};

3.1.1.4 Robinson Guard滤波器
Robinson Guard滤波器是一种非线性非参数型滤波器，当窗口大小为５时，模板结构如图所示
 
中心像素点周围不存在权值的区域称为保护带，它的存在克服了普通边缘滤波器只给出目标边缘信息而滤除了目标内部信息的缺点，其杂波抑制准则可表示为
 
式中：Ｚｊ 为模板中编号ｊ 处像素的灰度值；Ｘ 为中心像素点的灰度值。
传统 Robinson Guard滤波器的局限性在于窗口尺寸无法自适应小目标的尺寸和形状，窗口过小会使保护机制起不到应有的作用，影响目标信息的完整性，甚至会将目标滤除，而窗口过大则容易引入复杂背景中噪声的干扰。克服这个缺点主要有两种方法：
一是将它与形态学方法相结合来抑制噪声及背景［２０－２１］，由于形态学操作可以在一定程度上消除目标尺寸和形状带来的影响，因此一般将形态学操作用于 Robinson Guard滤波之前；
二是使 Robinson Guard滤波器能够自适应调节窗口大小。Ｚｈａｎｇ等［２２］基于这种思想，首先利用图像局部对比度的方法来对感兴趣区域（ＲＯＩ）初步获取目标的尺寸，并据此构造 Robinson Guard滤波器原始窗口，之后对该窗口进行放大或缩小以形成多尺度窗口。多尺度窗口处理得到的数据能够更充分地反映不同大小目标的邻域信息，进而提升算法检测性能及稳健性。
3.1.1.5 双边滤波方法
为了在滤波过程中引入更多信息，Tomasi等［２３］提出了双边滤波方法（ＢＦ），通过两个高斯滤波器来对所要处理的像素点与其邻域的空间关系和强度关系进行综合考虑，达到锐度增强和噪声去除的目的。双边滤波器之所以能够做到在平滑去噪的同时还能够很好的保存边缘（Edge Preserve），是由于其滤波器的核由两个函数生成：
	一个函数由像素欧式距离决定滤波器模板的系数
	另一个函数由像素的灰度差值决定滤波器的系数
其综合了高斯滤波器（Gaussian Filter）和α-截尾均值滤波器（Alpha-Trimmed mean Filter）的特点。高斯滤波器只考虑像素间的欧式距离，其使用的模板系数随着和窗口中心的距离增大而减小；Alpha截尾均值滤波器则只考虑了像素灰度值之间的差值，去掉α%的最小值和最大值后再计算均值。







双边滤波得原理示意图如下所示：
 
在双边滤波器中，输出像素得值依赖于邻域像素值得加权值组合：
 
而加权系数w(i,j,k,l)取决于空域核和值域核的乘积。(i,j)，(k,l)分别指两个像素点的坐标。
其中空域核公式如下：
 
其中,(k,l)为模板窗口的中心坐标；(i,j)为模板窗口的其他系数的坐标；σd为高斯函数的标准差。 使用该公式生成的滤波器模板和高斯滤波器使用的模板是没有区别的。
值域核的生成公式如下：
 
其中，函数f(x,y)表示要处理的图像，f(x,y)表示图像在点(x,y)处的像素值；(k,l)为模板窗口的中心坐标；(i,j)为模板窗口的其他系数的坐标；σr为高斯函数的标准差。
将上述两个模板相乘就得到了双边滤波器的模板。
 

3.1.1.6 形态学方法
数学形态学操作可以分为二值形态学和灰度形态学，灰度形态学由二值形态学扩展而来。数学形态学有2个基本的运算，即腐蚀和膨胀，而腐蚀和膨胀通过结合又形成了开运算和闭运算。
开运算就是先腐蚀再膨胀，闭运算就是先膨胀再腐蚀。
膨胀
结构元素B可以看作一个卷积模板，区别在于膨胀是以集合运算为基础的，卷积是以算术运算为基础的，但两者的处理过程是相似的。
⑴ 用结构元素B，扫描图像A的每一个像素
⑵ 用结构元素与其覆盖的二值图像做“或”操作
⑶ 如果都为0，结果图像的该像素为0。否则为1
另外一种定义是：图像A与形态核B进行卷积，计算核B覆盖的区域的像素点的最大值，并把这个最大值赋值给参考点指定的像素。
 
腐蚀
腐蚀可以使目标区域范围“变小”，其实质造成图像的边界收缩，可以用来消除小且无意义的目标物。式子表达为：
 
对Z中的集合A和B，B对A进行腐蚀的整个过程如下：
⑴ 用结构元素B，扫描图像A的每一个像素
⑵ 用结构元素与其覆盖的二值图像做“与”操作
⑶ 如果都为1，结果图像的该像素为1。否则为0
腐蚀在数学形态学运算中的作用是消除物体边界点。
 
在利用形态学方法进行红外弱小目标检测时，Ｔｏｐ－Ｈａｔ变换最为常用。
Tophat变换是原图像与开运算结果之差，突显出图像轮廓周围更亮的区域。开运算(Opening)是先腐蚀后膨胀的过程。开运算一般是对象的轮廓变得更加光滑，断开狭窄的间断和消除细小的凸起物。
具体的计算公式如下:
 
3.1.1.7 高斯滤波
高斯滤波是一种线性平滑滤波，适用于消除高斯噪声。高斯滤波器是根据高斯函数的形状来选择权值的线性平滑滤波器。高斯滤波的重要两步就是先找到高斯模板然后再进行卷积。
高斯函数
 
注：σ的大小决定了高斯函数的宽度。
高斯核
假定中心点的坐标是（0,0），那么取距离它最近的8个点坐标，为了计算，需要设定σ的值。假定σ=1.5，则模糊半径为1的高斯模板就算如下：
 

权重矩阵中所有点的权重和为1，上图窗口总的权重总和为0.4787147，因此上面9个值还要分别除以0.4787147，得到最终的高斯模板。

 
高斯滤波计算
假设现有9个像素点，灰度值（0-255）如下：
 
每个点乘以自己的权重值：
 
得到
 
将这9个值加起来，就是中心点的高斯模糊的值。
3.2.1 基于变换域滤波得方法
3.2.1.1 小波变换
首先通过相应的变换得到变换域信息，然后对变换域信息进行处理，最后通过反变换将其变换回空间域，实现对红外弱 小目标的检测。
粒子滤波

多尺度Gabor滤波器

BP神经网络

主成分分析PCA降维处理：提取48个纹理特征,采用主成分分析PCA降维处理,解决了Gabor滤波器应用中的瓶颈问题,即匕特征矢量维数较高,以及由此产生的较大计算量。
LOG滤波
双正交小波结合粒子滤波
群优化PSO得到Gabor滤波器组
双树复小波变换
混沌粒子群优化
类内绝对差
形态滤波

3.2 基于人类视觉系统方法
3.2.1 基于频谱残差法的显著性检测
基于频谱残差法的显著性检测的基本原则是对频繁出现的响应进行抑制，同时保持对于偏离规范的特征的敏感性。
主 要 步 骤为：首先通过傅里叶变换得到图像的log谱，然后将局部均值滤波器处理前后的log谱进行差分得到频谱残差，再对得到的频谱残差进行傅里叶逆变换，并对结果用高斯滤波器进行平滑，最后通过阈值分割得到显著图。
改进：
	与主成分分析法及尺度空间理论等相结合来进行红外弱小目标的检测。
	采用频率调谐的方式，利用幅度谱的局部均值和方差设定自适应阈值的方法在阈值选取方面进行改进。并在得到显著性区域后根据小目标的局部梯度特征及极值特征将目标检测与角点检测相联系，进一步提取候选目标。
	SR法
	SR频域检测方法：将输入的图像 f(x, y) 变换到频域为 F(f)(u,v) ，它的相位谱与幅度谱分别记为A(u,v) =F(f)和 ∅(u, v)=angle(F( f)) ，然后对幅度谱做对数变换记为 L(u,v) =log(A(u,v))，用 LOG 幅度谱与平滑之后的 LOG 幅度谱进行相减即得到了幅度谱残差，其公式如下：
 
其中h_n 为均值滤波函数，最后将幅度谱残差和未经处理的相位谱带入傅立叶反变换
得到原图的显著图 S(x, y)，其公式如下：
 
为了得到效果更好的显著图，最后做了高斯平滑。上面的公式可以写成如下形式：
 
并引入方向特征，将一阶梯Sobel算子同SR模型结合，得到水平和垂直方向的梯度特征，在利用SR模型提取显著性图，最后进行显著性特征融合得到最终的显著性图.
SR方法的流程如下图所示：
 
Sobel 的垂直和水平算子如下表示
 
3.2.2 基于局部对比度的方法(LCM)
基于ＬＣＭ 的方法是由Ｃｈｅｎ等［５９］于２０１４年提出的，主要利用空间域的局部信息，先将图像块与其邻域间的局部对比度作为局部特征来构建显著图，然后在显著图中通过阈值分割出小目标，最后将显著图中目标的位置与原图像对应，实现对红外弱小目标的检测。其中显著图的获取方式是该类算法的关键，将极大影响算法性能。
 
式中：ｍｉ 表示图４中编号为ｉ区域内的灰度均值；Ｌs表示“０”区域中灰度的最大值；ｓ表示对于整幅图像而言“０”区域所在位置的编号。
LCM算法中构建显著图的方法为：首先通过窗口滑动获取图像上的相应区域，并将该区域分成图４所示的９个部分；然后通过（７）式和（８）式进行计算；最后将窗口滑动到各位置时计算得到的 Ｃｓ 值赋给对应的“０”区域构建整幅图像的显著图。
 
图4 
Ｑｉｎ等［６１］提出了一种新型局部对比度测量（ＮＬＣＭ）的红外弱小目标检测方法，基于灰度值的排序，引入自定义的均值和方差两个参数计算显著图，消除了高强度脉冲噪声的影响，进一步提高了 ＬＣＭ 算法的检测效果。
Ｂａｉ［６４］提出了一种基于导数熵对比度测量(DECM)的方法。通过计算某个小平面内不同方向上的导数，并将其与熵的概念相结合，得到各方向导数所对应的对比度测量图，将这些对比度测量图融合的结果用于对小目标的检测。
